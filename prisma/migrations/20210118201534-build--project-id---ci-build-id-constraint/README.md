# Migration `20210118201534-build--project-id---ci-build-id-constraint`

This migration has been generated by Pavel Strunkin at 1/18/2021, 10:15:34 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "Build.ciBuildId_unique"

CREATE UNIQUE INDEX "Build.projectId_ciBuildId_unique" ON "Build"("projectId", "ciBuildId")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201201211711-test-run--temp-ignore-areas-added..20210118201534-build--project-id---ci-build-id-constraint
--- datamodel.dml
+++ datamodel.dml
@@ -1,17 +1,16 @@
 generator client {
-  provider        = "prisma-client-js"
-  previewFeatures = ["atomicNumberOperations"]
+  provider = "prisma-client-js"
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Build {
   id         String    @id @default(uuid())
-  ciBuildId  String?   @unique
+  ciBuildId  String?
   number     Int?
   branchName String?
   status     String?
   testRuns   TestRun[]
@@ -21,8 +20,10 @@
   createdAt  DateTime  @default(now())
   user       User?     @relation(fields: [userId], references: [id])
   userId     String?
   isRunning  Boolean?
+
+  @@unique([projectId, ciBuildId])
 }
 model Project {
   id             String          @id @default(uuid())
```


