# Migration `20200524122552-baseline-history`

This migration has been generated by Pavel Strunkin at 5/24/2020, 12:25:52 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Baseline" (
"baselineName" text  NOT NULL ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"id" text  NOT NULL ,"testRunId" text  NOT NULL ,"testVariationId" text  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "Baseline_testRunId" ON "public"."Baseline"("testRunId")

ALTER TABLE "public"."Baseline" ADD FOREIGN KEY ("testVariationId")REFERENCES "public"."TestVariation"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Baseline" ADD FOREIGN KEY ("testRunId")REFERENCES "public"."TestRun"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200523130656-test-run-owns-variation-data..20200524122552-baseline-history
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = env("DATABASE_URL")
 }
 model Build {
   id         String    @default(uuid()) @id
@@ -51,26 +51,40 @@
   os                    String?
   viewport              String?
   baselineName          String?
   ignoreAreas           String        @default("[]")
+  // Baseline
+  baseline              Baseline
 }
 model TestVariation {
-  id           String    @default(uuid()) @id
+  id           String     @default(uuid()) @id
   name         String
   browser      String?
   device       String?
   os           String?
   viewport     String?
   baselineName String?
-  ignoreAreas  String    @default("[]")
+  ignoreAreas  String     @default("[]")
   projectId    String
-  project      Project   @relation(fields: [projectId], references: [id])
+  project      Project    @relation(fields: [projectId], references: [id])
   testRuns     TestRun[]
-  updatedAt    DateTime  @updatedAt
-  createdAt    DateTime  @default(now())
+  baselines    Baseline[]
+  updatedAt    DateTime   @updatedAt
+  createdAt    DateTime   @default(now())
 }
+model Baseline {
+  id              String        @default(uuid()) @id
+  baselineName    String
+  updatedAt       DateTime      @updatedAt
+  createdAt       DateTime      @default(now())
+  testVariation   TestVariation @relation(fields: [testVariationId], references: [id])
+  testVariationId String
+  testRunId       String
+  testRun         TestRun       @relation(fields: [testRunId], references: [id])
+}
+
 model User {
   id        String   @default(uuid()) @id
   email     String   @unique
   password  String
```


